<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ã‚·ãƒ£ã‚«ã‚·ãƒ£ã‚«</title>
    <style>
        html, body { margin: 0; overflow: hidden; position: fixed; width: 100%; height: 100%; background: #f0f0f0; touch-action: none; }
        .box { position: absolute; will-change: transform; }
        .box img { width: 100px; height: auto; display: block; pointer-events: none; }
        /* ç”»åƒãŒãªã„æ™‚ã®ä»£ã‚ã‚Šã®ç®± */
        .no-img { width: 100px; height: 100px; background: #ccc; display: flex; justify-content: center; align-items: center; font-size: 40px; }
        button { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); padding: 20px; z-index: 1000; }
    </style>
</head>
<body>
    <button id="startBtn">ã‚¹ã‚¿ãƒ¼ãƒˆï¼ ğŸ”¥</button>
    <script>
        const boxes = [];
        // ã“ã“ã‚’ 1ã€œ2 ãªã©ã€ä»ŠæŒã£ã¦ã‚‹æšæ•°ã«åˆã‚ã›ã¦å¤‰ãˆã‚‹ã ã‘ã§OKï¼
        const numImages = 9; 

        for (let i = 1; i <= numImages; i++) {
            const div = document.createElement('div');
            div.className = 'box';
            
            const img = new Image();
            img.src = `${i}.png`;
            // ç”»åƒãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸã‚‰æ–‡å­—ã‚’å‡ºã™
            img.onerror = () => {
                div.innerHTML = `<div class="no-img">ğŸ“·</div>`;
                data.h = 100;
            };
            img.onload = () => { data.h = 100 * (img.naturalHeight / img.naturalWidth); };
            
            div.appendChild(img);
            document.body.appendChild(div);

            const data = {
                el: div, px: Math.random()*200, py: Math.random()*200,
                vx: 0, vy: 0, angle: 0, va: 0, w: 100, h: 100, isDragging: false
            };
            boxes.push(data);
        }

        document.getElementById('startBtn').onclick = function() {
            if (typeof DeviceMotionEvent.requestPermission === 'function') {
                DeviceMotionEvent.requestPermission().then(run);
            } else { run(); }
            this.style.display = 'none';
        };

        function run() {
            window.addEventListener("devicemotion", (e) => {
                let ag = e.accelerationIncludingGravity;
                boxes.forEach(b => { 
                    b.vx -= ag.x * 0.7; b.vy += ag.y * 0.7; b.va += ag.x * 0.4;
                });
            });

            function update() {
                boxes.forEach(b => {
                    b.vx *= 0.95; b.vy *= 0.95; b.va *= 0.95;
                    b.px += b.vx; b.py += b.vy; b.angle += b.va;
                    // å£åˆ¤å®š
                    if (b.px < 0) { b.px = 0; b.vx *= -0.8; }
                    if (b.px > window.innerWidth - 100) { b.px = window.innerWidth - 100; b.vx *= -0.8; }
                    if (b.py < 0) { b.py = 0; b.vy *= -0.8; }
                    if (b.py > window.innerHeight - b.h) { b.py = window.innerHeight - b.h; b.vy *= -0.8; }
                    b.el.style.transform = `translate(${b.px}px, ${b.py}px) rotate(${b.angle}deg)`;
                });
                requestAnimationFrame(update);
            }
            update();
        }
    </script>
</body>
</html>
